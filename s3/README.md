- [References](#references)
- [기술적 관점에서 본 Amazon S3 구현 방식](#기술적-관점에서-본-amazon-s3-구현-방식)
  - [1. 기본 구조](#1-기본-구조)
  - [2. 스토리지 매체와 성능 한계](#2-스토리지-매체와-성능-한계)
  - [3. 데이터 배치와 열 관리(Heat Management)](#3-데이터-배치와-열-관리heat-management)
  - [4. 내구성(Durability) 확보: 복제 + 이레이저 코딩](#4-내구성durability-확보-복제--이레이저-코딩)
  - [5. 운영과 품질 관리](#5-운영과-품질-관리)
  - [6. 요약](#6-요약)
- [S3에서 HDD와 SSD 사용 시 장단점](#s3에서-hdd와-ssd-사용-시-장단점)
  - [1. HDD (Hard Disk Drive)](#1-hdd-hard-disk-drive)
    - [장점](#장점)
    - [단점](#단점)
  - [2. SSD (Solid State Drive)](#2-ssd-solid-state-drive)
    - [장점](#장점-1)
    - [단점](#단점-1)
  - [3. S3 관점에서의 전략적 선택](#3-s3-관점에서의-전략적-선택)

------

# References

- [Building and operating a pretty big storage system called S3 | ycombinator](https://news.ycombinator.com/item?id=36894932)

# 기술적 관점에서 본 Amazon S3 구현 방식

## 1. 기본 구조

* **S3는 객체 스토리지(Object Storage) 서비스**이며, HTTP 기반 REST API를 통해 접근.
* 주요 구성 요소:

  * **프런트엔드 플릿(Fleet)**: API 요청을 처리하는 서버 그룹.
  * **네임스페이스 서비스**: 객체 이름과 위치를 관리.
  * **스토리지 플릿**: 수백만 개의 하드디스크(HDD)로 이루어진 실제 데이터 저장소.
  * **백그라운드 플릿**: 복제(Replication), 티어링(Tiering), 데이터 재구성 등 관리 작업 수행.

👉 전체 시스템은 수백 개의 **마이크로서비스**로 쪼개져 있으며, 각 팀이 API 단위로 계약을 맺고 독립적으로 운영.

---

## 2. 스토리지 매체와 성능 한계

* **HDD 중심**으로 구축. SSD는 성능은 좋지만 비용 효율이 떨어지므로 대규모 저장에는 HDD가 유리.
* HDD는 용량은 수십 년간 **수백만 배 증가**했지만, **성능(랜덤 I/O 처리 속도)** 은 기계적 한계 때문에 제자리 수준.

  * 초당 약 120 IOPS(임의 작업) → 20년 이상 거의 변하지 않음.
* 앞으로 200TB HDD가 등장할 것으로 예상되며, 이 경우 2TB당 초당 1 I/O만 허용됨.

👉 따라서 S3는 **대용량 HDD를 최대한 활용하면서 성능 저하를 방지하는 아키텍처**를 설계해야 했음.

---

## 3. 데이터 배치와 열 관리(Heat Management)

* **열(Heat)** = 특정 시점에 특정 디스크에 몰리는 요청 수.
* 요청이 특정 디스크에 몰리면 **핫스팟(Hotspot)** 이 발생 → 꼬리 지연(Tail Latency) 유발.
* 해결 전략:

  * 데이터 배치를 최대한 **넓게 분산**.
  * 워크로드를 수백만 개 디스크에 나누어 요청을 퍼뜨려 버스트 트래픽에도 대응.
  * 집합적으로 수많은 워크로드가 동시에 섞이면, 개별 워크로드의 불규칙성이 평균화되어 **예측 가능한 패턴**으로 바뀜.

---

## 4. 내구성(Durability) 확보: 복제 + 이레이저 코딩

* **복제(Replication)**

  * 동일한 데이터를 여러 디스크에 저장 → 장애 시 다른 복제본에서 읽음.
  * 읽기 성능 향상에 유리하지만, 용량 낭비가 큼.
* **이레이저 코딩(Erasure Coding, 예: Reed-Solomon)**

  * 데이터를 여러 조각(k)과 패리티(m)로 나눔.
  * 전체 (k+m) 조각 중 k개만 있으면 원본 복구 가능.
  * 용량 효율을 높이면서도 장애 허용 유지.
* **데이터를 다양한 디스크 세트에 고르게 분산**하여 워크로드 격리와 버스트 대응 가능.

---

## 5. 운영과 품질 관리

* **내구성 리뷰(Durability Review)**

  * 코드 변경 시 발생 가능한 모든 위협을 나열하고, 그에 대한 대응 방안 점검.
  * 위험을 세부 대응책보다 **거친 안전장치(Guardrails)** 로 막는 방식 선호.
* **ShardStore**

  * 디스크 단위 스토리지 관리 계층을 Rust로 새로 구현.
  * 타입 안정성(Type Safety) 확보 및 형식 검증(Formal Verification) 기법 도입.
  * 단순화된 모델과 실제 구현을 나란히 두어 지속적으로 검증.

---

## 6. 요약

* S3는 **수백만 개의 HDD와 수백 개의 마이크로서비스**로 이루어진 초대규모 분산 스토리지 시스템.
* **핵심 설계 철학**:

  1. **비용 효율** → 최대한 큰 HDD를 활용.
  2. **성능 확보** → 데이터와 요청을 균일하게 분산(열 관리).
  3. **내구성 보장** → 복제 + 이레이저 코딩으로 장애 대응.
  4. **안정적 운영** → 내구성 리뷰, 형식 검증, 팀 단위 API 계약.

즉, S3는 단순한 스토리지 소프트웨어가 아니라, **소프트웨어·하드웨어·사람이 결합된 하나의 유기체 같은 시스템**이라고 할 수 있습니다.

---

# S3에서 HDD와 SSD 사용 시 장단점

## 1. HDD (Hard Disk Drive)

### 장점

* **비용 효율성**: GB당 비용이 SSD보다 훨씬 저렴 → S3처럼 수백 엑사바이트(EB) 단위 데이터를 저장해야 하는 서비스에는 필수.
* **대용량 드라이브 가능**: 20TB 이상, 앞으로 200TB까지도 발전 예정 → 대규모 저장소 구축에 유리.
* **검증된 기술**: 수십 년간 발전해온 안정적인 매체로, 운영 경험과 도구가 풍부.

### 단점

* **성능 한계**: 랜덤 IOPS(임의 읽기/쓰기)는 초당 120회 수준 → 20년 넘게 큰 개선이 없음.
* **기계적 취약성**: 회전 플래터와 움직이는 암(arm) 때문에 SSD보다 고장 확률이 높음.
* **응답 지연**: 기계적 탐색(seek time)으로 인해 지연(latency)이 SSD보다 훨씬 김.

---

## 2. SSD (Solid State Drive)

### 장점

* **빠른 성능**: IOPS가 HDD보다 수천 배 높음, 지연도 훨씬 낮음 → 빠른 읽기/쓰기 요청 처리 가능.
* **내구성**: 기계적 부품이 없어 충격에 강하고, 고장 패턴이 예측 가능.
* **저전력/소형화**: 에너지 효율성이 높고 공간 절약 가능.

### 단점

* **비용**: GB당 비용이 HDD보다 훨씬 높음 → S3 전체 데이터를 SSD로 운영하기에는 경제적으로 부담.
* **수명 제한**: 쓰기 횟수(Program/Erase Cycle)에 따른 마모가 존재.
* **대용량 제한**: HDD처럼 수십 TB 단위의 고용량 모델은 드물고, 가격도 매우 비쌈.

---

## 3. S3 관점에서의 전략적 선택

* S3는 **비용 대비 저장 용량**을 최우선하기 때문에, **대부분 HDD 기반**으로 운영.
* SSD는 메타데이터 관리, 자주 접근되는 소량의 핫 데이터, 캐싱 계층 등에 활용.
* 즉, **“대용량 저장은 HDD, 고속 접근은 SSD”**라는 혼합 접근(Hybrid Approach)이 가장 효율적.

---

✅ 정리하면,

* **HDD** = 싸고 크지만 느림.
* **SSD** = 빠르고 튼튼하지만 비쌈.
* S3는 전 세계 고객의 데이터를 “무제한에 가깝게” 저장해야 하므로 HDD 중심 설계가 맞지만, 성능 병목을 보완하기 위해 SSD를 보조적으로 사용합니다.
